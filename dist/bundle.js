!function(n,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Mention=t():n.Mention=t()}(window,(function(){return function(n){var t={};function e(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return n[o].call(i.exports,i,i.exports,e),i.l=!0,i.exports}return e.m=n,e.c=t,e.d=function(n,t,o){e.o(n,t)||Object.defineProperty(n,t,{enumerable:!0,get:o})},e.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},e.t=function(n,t){if(1&t&&(n=e(n)),8&t)return n;if(4&t&&"object"==typeof n&&n&&n.__esModule)return n;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:n}),2&t&&"string"!=typeof n)for(var i in n)e.d(o,i,function(t){return n[t]}.bind(null,i));return o},e.n=function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(t,"a",t),t},e.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},e.p="/",e(e.s=0)}([function(n,t,e){function o(n){return function(n){if(Array.isArray(n))return i(n)}(n)||function(n){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(n))return Array.from(n)}(n)||function(n,t){if(!n)return;if("string"==typeof n)return i(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);"Object"===e&&n.constructor&&(e=n.constructor.name);if("Map"===e||"Set"===e)return Array.from(n);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return i(n,t)}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,o=new Array(t);e<t;e++)o[e]=n[e];return o}function r(n,t){for(var e=0;e<t.length;e++){var o=t[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(n,o.key,o)}}function s(n,t,e){return t&&r(n.prototype,t),e&&r(n,e),n}e(1).toString();var a=function(){function n(t){var e,o,i,r,s=t.api;!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.api=s,this.CSS={mentionToolbarBlock:"cdx-mention-toolbar-block",mentionContainer:"cdx-mention__container",mentionInput:"cdx-mention__input",mention:"cdx-mention",mentionIntro:"cdx-mention-suggestion__intro",mentionAvatar:"cdx-mention-suggestion__avatar",mentionTitle:"cdx-mention-suggestion__title",mentionDesc:"cdx-mention-suggestion__desc",suggestionContainer:"cdx-mention-suggestion-container",suggestion:"cdx-mention-suggestion",inlineToolBar:"ce-inline-toolbar",inlineToolBarOpen:"ce-inline-toolbar--showed",inlineToolbarButtons:"ce-inline-toolbar__buttons"},this.iconClasses={base:this.api.styles.inlineToolButton,active:this.api.styles.inlineToolButtonActive},this.mentionContainer=this._make("div",[this.CSS.mentionContainer],{}),this.suggestionContainer=this._make("div",[this.CSS.suggestionContainer],{}),this.mentionInput=this._make("input",[this.CSS.mentionInput],{innerHTML:"你想 @ 谁?",autofocus:!0}),this.mentionContainer.appendChild(this.mentionInput),this.mentionContainer.appendChild(this.suggestionContainer),this.mentionInput.addEventListener("keyup",(e=this.handleMentionInput.bind(this),o=300,function(){var n=this,t=arguments,s=function(){r=null,i||e.apply(n,t)},a=i&&!r;clearTimeout(r),r=setTimeout(s,o),a&&e.apply(n,t)}))}return s(n,null,[{key:"isInline",get:function(){return!0}}]),s(n,[{key:"handleMentionInput",value:function(n){if("Escape"===n.code)return this.closeMentionPopover();if("Enter"===n.code)return console.log("select first item");console.log("ev: ",n.code);var t=this.makeSuggestion({id:1,title:"mydaerxym",desc:"author of the ..",avatar:"https://avatars0.githubusercontent.com/u/6184465?s=40&v=4"}),e=this.makeSuggestion({id:2,title:"mydaerxym2",desc:"author of the ..",avatar:"https://avatars0.githubusercontent.com/u/6184465?s=40&v=4"});this.suggestionContainer.appendChild(t),this.suggestionContainer.appendChild(e)}},{key:"makeSuggestion",value:function(n){var t=this,e=document.querySelector("#"+this.CSS.mention),o=this._make("div",[this.CSS.suggestion],{}),i=this._make("img",[this.CSS.mentionAvatar],{src:n.avatar}),r=this._make("div",[this.CSS.mentionIntro],{}),s=this._make("div",[this.CSS.mentionTitle],{innerText:n.title}),a=this._make("div",[this.CSS.mentionDesc],{innerText:n.desc});return o.appendChild(i),r.appendChild(s),r.appendChild(a),o.appendChild(r),o.addEventListener("click",(function(){console.log("click user: ",n),e.innerHTML=n.title,t.closeMentionPopover()})),o}},{key:"closeMentionPopover",value:function(){var n=this;this.clearSuggestions();var t=document.querySelector("#"+this.CSS.mention),e=document.querySelector("."+this.CSS.inlineToolBar);console.log("this.mentionInput: ",this.mentionInput),this.mentionInput.value="",e.classList.remove(this.CSS.inlineToolBarOpen),t.focus(),this.moveCaretToMentionEnd(),setTimeout((function(){n.removeAllHolderIds()}),50)}},{key:"render",value:function(){return this._make("div",[this.CSS.mentionToolbarBlock],{})}},{key:"surround",value:function(n){}},{key:"moveCaretToMentionEnd",value:function(){var n,t;if(window.getSelection&&(n=window.getSelection(),t=document.createRange(),n.rangeCount>0)){for(var e=document.querySelector(".ce-paragraph"),o=0,i=0;i<e.childNodes.length;i++){e.childNodes[i].id===this.CSS.mention&&(o=i)}t.setStart(e.childNodes[o+2],0),t.collapse(!0),n.removeAllRanges(),n.addRange(t),e.focus()}}},{key:"checkState",value:function(){var n=this.api.selection.findParentTag("SPAN",this.CSS.mention);return n&&n.id===this.CSS.mention?this.handleMentionActions():this.handleNormalActions()}},{key:"handleNormalActions",value:function(){this.mentionContainer.hidden=!0,document.querySelector("."+this.CSS.inlineToolbarButtons).style.display="block"}},{key:"clearSuggestions",value:function(){for(var n=document.querySelector("."+this.CSS.suggestionContainer);n.firstChild;)n.removeChild(n.firstChild)}},{key:"removeAllHolderIds",value:function(){return document.querySelectorAll("."+this.CSS.mention).forEach((function(n){return n.removeAttribute("id")})),!1}},{key:"handleMentionActions",value:function(){var n=this;console.log("handleMentionActions"),this.mentionContainer.hidden=!1,this.clearSuggestions(),this.mentionInput.value="",document.querySelector("."+this.CSS.inlineToolbarButtons).style.display="none",setTimeout((function(){n.mentionInput.focus()}),100)}},{key:"renderActions",value:function(){return this.mentionInput.placeholder="你想 @ 谁?",this.mentionContainer}},{key:"_make",value:function(n){var t,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=document.createElement(n);Array.isArray(e)?(t=r.classList).add.apply(t,o(e)):e&&r.classList.add(e);for(var s in i)r[s]=i[s];return r}},{key:"toolboxIcon",get:function(){return'<svg width="34" height="34" xmlns="http://www.w3.org/2000/svg"><path d="M17.78 19.543l3.085 1.78-.825 1.499-1.04-.033-1.03 1.784h-2.075l1.575-2.73-.537-.82.848-1.48zm.578-1.007l3.83-6.687a1.688 1.688 0 0 1 2.303-.626l.003.002a1.725 1.725 0 0 1 .65 2.327l-3.719 6.755-3.067-1.771zm-8.17 3.665h3.662a1.187 1.187 0 0 1 0 2.374h-3.663a1.187 1.187 0 1 1 0-2.374z"/></svg>'}}],[{key:"sanitize",get:function(){return{mention:{class:this.CSS&&this.CSS.mention}}}}]),n}();n.exports=a},function(n,t,e){var o=e(2);"string"==typeof o&&(o=[[n.i,o,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};e(4)(o,i);o.locals&&(n.exports=o.locals)},function(n,t,e){(n.exports=e(3)(!1)).push([n.i,'.cdx-mention-toolbar-block {\n  display: inline-block;\n}\n\n.cdx-mention {\n  color: #1785a9;\n  font-weight: bold;\n  outline: none;\n}\n.cdx-mention::before {\n  content: "a";\n  border: 1px solid #1785a9;\n  color: #1785a9;\n  width: 12px;\n  height: 12px;\n  margin-right: 2px;\n  border-radius: 100%;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 16px;\n  transform: rotateZ(10deg);\n  padding-bottom: 2px;\n  font-family: serif;\n}\n.cdx-mention__container {\n  padding: 5px;\n  padding-bottom: 0px;\n}\n.cdx-mention__input {\n  outline: none;\n  box-sizing: border-box;\n  margin: 0;\n  padding: 5px;\n  font-variant: tabular-nums;\n  list-style: none;\n  font-feature-settings: "tnum";\n  position: relative;\n  display: inline-block;\n  width: 150px;\n  height: 26px;\n  color: rgba(0, 0, 0, 0.65);\n  font-size: 14px;\n  line-height: 1.2;\n  background-color: #f1f3f7;\n  background-image: none;\n  border: 1px solid #eaeaea;\n  border-radius: 4px;\n  -webkit-transition: all 0.3s;\n  transition: all 0.3s;\n}\n\n.cdx-mention-suggestion-container {\n  width: 100%;\n  min-height: 1px;\n  max-height: 300px;\n  overflow: hidden;\n  margin-top: 5px;\n}\n\n.cdx-mention-suggestion {\n  display: flex;\n  justify-content: left;\n  align-items: center;\n  height: 40px;\n  padding-top: 3px;\n  padding-bottom: 3px;\n  cursor: pointer;\n}\n\n.cdx-mention-suggestion:first-child {\n  background: #f1f3f7;\n  opacity: 0.9;\n}\n\n.cdx-mention-suggestion:hover {\n  background: #f1f3f7;\n}\n\n.cdx-mention-suggestion__avatar {\n  width: 25px;\n  height: 25px;\n  border-radius: 100%;\n  display: block;\n  margin-right: 8px;\n}\n\n.cdx-mention-suggestion__intro {\n  display: flex;\n  flex-direction: column;\n}\n\n.cdx-mention-suggestion__title {\n  color: #828282;\n}\n\n.cdx-mention-suggestion__desc {\n  color: #b5b5b5;\n}\n',""])},function(n,t){n.exports=function(n){var t=[];return t.toString=function(){return this.map((function(t){var e=function(n,t){var e=n[1]||"",o=n[3];if(!o)return e;if(t&&"function"==typeof btoa){var i=(s=o,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),r=o.sources.map((function(n){return"/*# sourceURL="+o.sourceRoot+n+" */"}));return[e].concat(r).concat([i]).join("\n")}var s;return[e].join("\n")}(t,n);return t[2]?"@media "+t[2]+"{"+e+"}":e})).join("")},t.i=function(n,e){"string"==typeof n&&(n=[[null,n,""]]);for(var o={},i=0;i<this.length;i++){var r=this[i][0];"number"==typeof r&&(o[r]=!0)}for(i=0;i<n.length;i++){var s=n[i];"number"==typeof s[0]&&o[s[0]]||(e&&!s[2]?s[2]=e:e&&(s[2]="("+s[2]+") and ("+e+")"),t.push(s))}},t}},function(n,t,e){var o,i,r={},s=(o=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===i&&(i=o.apply(this,arguments)),i}),a=function(n){return document.querySelector(n)},u=function(n){var t={};return function(n){if("function"==typeof n)return n();if(void 0===t[n]){var e=a.call(this,n);if(window.HTMLIFrameElement&&e instanceof window.HTMLIFrameElement)try{e=e.contentDocument.head}catch(n){e=null}t[n]=e}return t[n]}}(),l=null,c=0,d=[],f=e(5);function p(n,t){for(var e=0;e<n.length;e++){var o=n[e],i=r[o.id];if(i){i.refs++;for(var s=0;s<i.parts.length;s++)i.parts[s](o.parts[s]);for(;s<o.parts.length;s++)i.parts.push(b(o.parts[s],t))}else{var a=[];for(s=0;s<o.parts.length;s++)a.push(b(o.parts[s],t));r[o.id]={id:o.id,refs:1,parts:a}}}}function h(n,t){for(var e=[],o={},i=0;i<n.length;i++){var r=n[i],s=t.base?r[0]+t.base:r[0],a={css:r[1],media:r[2],sourceMap:r[3]};o[s]?o[s].parts.push(a):e.push(o[s]={id:s,parts:[a]})}return e}function m(n,t){var e=u(n.insertInto);if(!e)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var o=d[d.length-1];if("top"===n.insertAt)o?o.nextSibling?e.insertBefore(t,o.nextSibling):e.appendChild(t):e.insertBefore(t,e.firstChild),d.push(t);else if("bottom"===n.insertAt)e.appendChild(t);else{if("object"!=typeof n.insertAt||!n.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var i=u(n.insertInto+" "+n.insertAt.before);e.insertBefore(t,i)}}function g(n){if(null===n.parentNode)return!1;n.parentNode.removeChild(n);var t=d.indexOf(n);t>=0&&d.splice(t,1)}function v(n){var t=document.createElement("style");return void 0===n.attrs.type&&(n.attrs.type="text/css"),y(t,n.attrs),m(n,t),t}function y(n,t){Object.keys(t).forEach((function(e){n.setAttribute(e,t[e])}))}function b(n,t){var e,o,i,r;if(t.transform&&n.css){if(!(r=t.transform(n.css)))return function(){};n.css=r}if(t.singleton){var s=c++;e=l||(l=v(t)),o=C.bind(null,e,s,!1),i=C.bind(null,e,s,!0)}else n.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(e=function(n){var t=document.createElement("link");return void 0===n.attrs.type&&(n.attrs.type="text/css"),n.attrs.rel="stylesheet",y(t,n.attrs),m(n,t),t}(t),o=w.bind(null,e,t),i=function(){g(e),e.href&&URL.revokeObjectURL(e.href)}):(e=v(t),o=k.bind(null,e),i=function(){g(e)});return o(n),function(t){if(t){if(t.css===n.css&&t.media===n.media&&t.sourceMap===n.sourceMap)return;o(n=t)}else i()}}n.exports=function(n,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=s()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var e=h(n,t);return p(e,t),function(n){for(var o=[],i=0;i<e.length;i++){var s=e[i];(a=r[s.id]).refs--,o.push(a)}n&&p(h(n,t),t);for(i=0;i<o.length;i++){var a;if(0===(a=o[i]).refs){for(var u=0;u<a.parts.length;u++)a.parts[u]();delete r[a.id]}}}};var S,x=(S=[],function(n,t){return S[n]=t,S.filter(Boolean).join("\n")});function C(n,t,e,o){var i=e?"":o.css;if(n.styleSheet)n.styleSheet.cssText=x(t,i);else{var r=document.createTextNode(i),s=n.childNodes;s[t]&&n.removeChild(s[t]),s.length?n.insertBefore(r,s[t]):n.appendChild(r)}}function k(n,t){var e=t.css,o=t.media;if(o&&n.setAttribute("media",o),n.styleSheet)n.styleSheet.cssText=e;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(e))}}function w(n,t,e){var o=e.css,i=e.sourceMap,r=void 0===t.convertToAbsoluteUrls&&i;(t.convertToAbsoluteUrls||r)&&(o=f(o)),i&&(o+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var s=new Blob([o],{type:"text/css"}),a=n.href;n.href=URL.createObjectURL(s),a&&URL.revokeObjectURL(a)}},function(n,t){n.exports=function(n){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!n||"string"!=typeof n)return n;var e=t.protocol+"//"+t.host,o=e+t.pathname.replace(/\/[^\/]*$/,"/");return n.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(n,t){var i,r=t.trim().replace(/^"(.*)"$/,(function(n,t){return t})).replace(/^'(.*)'$/,(function(n,t){return t}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(r)?n:(i=0===r.indexOf("//")?r:0===r.indexOf("/")?e+r:o+r.replace(/^\.\//,""),"url("+JSON.stringify(i)+")")}))}}])}));